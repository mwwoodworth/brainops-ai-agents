# BrainOps AI OS - Complete System Architecture

## Version: 3.0.0 | Last Updated: 2026-01-22
## Generated by: Claude Opus 4.5 - Comprehensive Production Analysis

---

## üèóÔ∏è ARCHITECTURE OVERVIEW

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        BRAINOPS AI OPERATING SYSTEM                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ  WEATHERCRAFT   ‚îÇ  ‚îÇ   MYROOFGENIUS  ‚îÇ  ‚îÇ  BRAINSTACK     ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ     ERP         ‚îÇ  ‚îÇ    (SaaS)       ‚îÇ  ‚îÇ   STUDIO        ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ  AI-Enhanced    ‚îÇ  ‚îÇ  Fully Auto     ‚îÇ  ‚îÇ  Tech Platform  ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îÇ           ‚îÇ                    ‚îÇ                    ‚îÇ                   ‚îÇ
‚îÇ           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îÇ
‚îÇ                                ‚îÇ                                        ‚îÇ
‚îÇ                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                           ‚îÇ
‚îÇ                    ‚îÇ   BRAINOPS BACKEND    ‚îÇ                           ‚îÇ
‚îÇ                    ‚îÇ   (FastAPI + Python)  ‚îÇ                           ‚îÇ
‚îÇ                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                           ‚îÇ
‚îÇ                                ‚îÇ                                        ‚îÇ
‚îÇ           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ           ‚îÇ                    ‚îÇ                    ‚îÇ                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îÇ
‚îÇ  ‚îÇ  AI AGENTS      ‚îÇ  ‚îÇ   UNIFIED     ‚îÇ  ‚îÇ    DATABASE     ‚îÇ          ‚îÇ
‚îÇ  ‚îÇ  (61 Active)    ‚îÇ  ‚îÇ    BRAIN      ‚îÇ  ‚îÇ   (Supabase)    ‚îÇ          ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ
‚îÇ                                                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìä SYSTEM INVENTORY

### Production Services

| Service | URL | Platform | Status |
|---------|-----|----------|--------|
| BrainOps AI Agents | brainops-ai-agents.onrender.com | Render | ‚úÖ LIVE |
| BrainOps Backend | brainops-backend-prod.onrender.com | Render | ‚úÖ LIVE |
| MCP Bridge | brainops-mcp-bridge.onrender.com | Render | ‚úÖ LIVE |
| Weathercraft ERP | weathercraft-erp.vercel.app | Vercel | ‚úÖ LIVE |
| MyRoofGenius | myroofgenius.com | Vercel | ‚úÖ LIVE |
| Database | Supabase PostgreSQL | Supabase | ‚úÖ LIVE |

### Render Service IDs
- **AI Agents**: `srv-d413iu75r7bs738btc10`
- **Backend**: `srv-d1tfs4idbo4c73di6k00`
- **MCP Bridge**: `srv-d4rhvg63jp1c73918770`

---

## üß† AI AGENT INVENTORY (61 Active)

### Core System Agents
| Agent | Purpose | Frequency |
|-------|---------|-----------|
| AUREA Orchestrator | Master AI orchestration | Always-on |
| Self-Healing Recovery | Automatic error recovery | Event-driven |
| Memory Manager | Unified memory operations | Continuous |
| Embedded Memory (RAG) | Vector search & retrieval | On-demand |
| Agent Scheduler | Job scheduling & execution | Continuous |

### Business Agents
| Agent | Purpose | Frequency |
|-------|---------|-----------|
| RevenueOptimizer | Revenue pipeline optimization | 6h |
| CustomerIntelligence | Customer analysis & insights | 4h |
| LeadScorer | Lead qualification scoring | On-demand |
| ProposalGenerator | AI proposal generation | On-demand |
| InvoicingAgent | Invoice management | On-demand |
| SchedulingAgent | Job scheduling & capacity | On-demand |

### Operations Agents
| Agent | Purpose | Frequency |
|-------|---------|-----------|
| SystemMonitor | Health monitoring | 5min |
| DevOpsOptimization | Infrastructure optimization | 4h |
| CodeQuality | Code review & quality | On-demand |
| DeploymentAgent | Deployment automation | Event-driven |
| SecurityMonitor | Security scanning | 1h |

### Intelligence Agents
| Agent | Purpose | Frequency |
|-------|---------|-----------|
| PredictiveAnalyzer | Business forecasting | 6h |
| CompetitiveIntelligence | Market analysis | 24h |
| ContentGenerator | AI content creation | On-demand |
| SEOOptimizer | Search optimization | 24h |

### Advanced AI Systems
| System | Purpose | Status |
|--------|---------|--------|
| OODA Loop | Observe-Orient-Decide-Act | ‚úÖ Active |
| Consciousness Emergence | Self-awareness loop | ‚úÖ Active |
| Hallucination Prevention | Output validation | ‚úÖ Active |
| Memory Enforcement (RBA/WBA) | Memory integrity | ‚úÖ Active |
| Circuit Breaker | Failure isolation | ‚úÖ Active |

---

## üíæ DATABASE SCHEMA (272 Tables)

### Core Tables
```sql
-- Agent Execution Tracking
ai_agent_executions (id, agent_name, status, created_at, completed_at, error_message)
ai_agent_registry (id, name, type, config, enabled)

-- Memory System
ai_persistent_memory (id, content, embedding, memory_type, importance, created_at)
unified_brain_logs (id, key, value, category, priority, source, metadata)

-- Revenue Pipeline
revenue_leads (id, email, name, source, status, score, pipeline_value)
gumroad_sales (id, sale_id, email, product_code, price, created_at)
gumroad_products (id, code, name, price, type)

-- Email Automation
ai_email_queue (id, recipient, subject, body, status, scheduled_for, sent_at)

-- System State
ai_system_state (id, component, state, last_heartbeat)
ai_system_alerts (id, severity, message, acknowledged, created_at)
```

### Key Relationships
- `ai_agent_executions` ‚Üí tracks all agent runs
- `unified_brain_logs` ‚Üí central knowledge store
- `revenue_leads` ‚Üí sales pipeline
- `ai_email_queue` ‚Üí outbound automation

---

## üîå API ENDPOINTS (58 Routers)

### Core APIs
| Router | Path | Purpose |
|--------|------|---------|
| health | /health | System health check |
| agents | /agents/* | Agent management |
| brain | /brain/* | Unified brain operations |
| memory | /memory/* | Memory CRUD |
| revenue | /revenue/* | Revenue pipeline |

### Integration APIs
| Router | Path | Purpose |
|--------|------|---------|
| gumroad_webhook | /gumroad/webhook | Gumroad sales processing |
| stripe_webhook | /stripe/webhook | Stripe payment events |
| mcp | /mcp/* | MCP bridge operations |

### Specialized APIs
| Router | Path | Purpose |
|--------|------|---------|
| a2ui | /a2ui/* | Agent-to-User interface |
| cicd | /cicd/* | CI/CD automation |
| digital_twin | /digital-twin/* | System simulation |
| observability | /observability/* | Monitoring dashboard |

---

## üîê CREDENTIALS & SECRETS

### Location
All credentials stored in: `/home/matt-woodworth/dev/_secure/BrainOps.env`

### Required Environment Variables
```bash
# Database
DB_HOST, DB_USER, DB_PASSWORD, DB_NAME, DATABASE_URL

# AI Services
ANTHROPIC_API_KEY, OPENAI_API_KEY, GOOGLE_AI_API_KEY, PERPLEXITY_API_KEY

# Integrations
STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET
GUMROAD_ACCESS_TOKEN, GUMROAD_WEBHOOK_SECRET
RESEND_API_KEY, SENDGRID_API_KEY
CONVERTKIT_API_KEY, CONVERTKIT_API_SECRET, CONVERTKIT_FORM_ID

# Deployment
RENDER_API_KEY, VERCEL_TOKEN, DOCKER_HUB_TOKEN, GITHUB_TOKEN

> Credentials are stored encrypted in `brainops_credentials`. Command Center decrypt requires `ENCRYPTION_KEY` in Vercel env.

# Security
API_KEYS, BRAINOPS_API_KEY
```

### Production Flags (CRITICAL)
```bash
OUTBOUND_EMAIL_MODE=live        # Real emails
GUMROAD_AUTOMATIONS_ENABLED=true # Gumroad automation
# Stripe keys start with ***REMOVED***_ (LIVE MODE)
```

---

## üöÄ DEPLOYMENT WORKFLOW

### BrainOps AI Agents (Docker ‚Üí Render)
```bash
# 1. Build
docker build -t mwwoodworth/brainops-ai-agents:latest -t mwwoodworth/brainops-ai-agents:vX.Y.Z .

# 2. Push
docker push mwwoodworth/brainops-ai-agents:latest
docker push mwwoodworth/brainops-ai-agents:vX.Y.Z

# 3. Deploy
curl -X POST "https://api.render.com/v1/services/srv-d413iu75r7bs738btc10/deploys" \
  -H "Authorization: Bearer $RENDER_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"clearCache":"clear"}'

# 4. Verify
curl -s "https://brainops-ai-agents.onrender.com/health" -H "X-API-Key: $BRAINOPS_API_KEY"
```

### Frontend Apps (Git ‚Üí Vercel)
```bash
git push origin main  # Auto-deploys via Vercel
```

---

## üìà REVENUE SYSTEMS

### Active Revenue Channels
| Channel | Platform | Products | Status |
|---------|----------|----------|--------|
| Gumroad | woodworthia.gumroad.com | 7 products ($37-$497) | ‚úÖ LIVE |
| MRG Marketplace | myroofgenius.com/marketplace | 7+ products | ‚úÖ LIVE |
| Stripe Subscriptions | Integrated | 3 tiers | ‚úÖ LIVE |

### Email Automation Pipeline
```
Purchase ‚Üí Webhook ‚Üí Database ‚Üí Email Queue ‚Üí Daemon ‚Üí Resend ‚Üí Customer
```

### Cross-Sell Integration
- MRG users ‚Üí Roofing Validator upsell
- BSS users ‚Üí Developer products upsell
- Runs daily via scheduled job

---

## üîç MONITORING & OBSERVABILITY

### Health Checks
- `/health` - System status, version, capabilities
- `/agents/executions` - Agent execution history
- `/scheduler/status` - Scheduled job status

### Key Metrics
- Agent success rate (target: >95%)
- Database connection pool health
- Email delivery rate
- Revenue pipeline value

### Alerting
- System alerts stored in `ai_system_alerts`
- Self-healing triggers on failures
- Slack/email notifications (configurable)

---

## üõ°Ô∏è SECURITY

### Authentication
- API key authentication for all secured endpoints
- Bearer token support
- Rate limiting (Redis-backed)

### Data Protection
- All credentials in secure env file
- No hardcoded secrets in code
- HTTPS enforced on all endpoints

### Access Control
- Tenant isolation in ERP
- Role-based access in frontend apps
- API key scoping by service

---

## üìö KEY DOCUMENTATION FILES

| File | Purpose |
|------|---------|
| `/home/matt-woodworth/CLAUDE.md` | Session initialization |
| `/home/matt-woodworth/dev/SESSION_STATE.md` | Current work state |
| `/home/matt-woodworth/dev/AI_SYSTEM_KNOWLEDGE_GRAPH.json` | Full system map |
| `/home/matt-woodworth/AI_ORCHESTRATION_SOP.md` | CLI reference |
| `/home/matt-woodworth/MASTER_SYSTEM_REGISTRY.md` | Architecture overview |

---

*This document is auto-generated and should be kept in sync with production systems.*
*Last verified: 2026-01-22*
