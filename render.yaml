# NOTE: Render dashboard is configured to use Docker Hub image, NOT this Dockerfile.
# Actual config: Image mode pulling docker.io/mwwoodworth/brainops-ai-agents:latest
# This file is kept for reference/backup. See DEPLOYMENT.md for actual workflow.
services:
  - type: web
    name: brainops-ai-agents
    runtime: image
    plan: standard
    image:
      url: docker.io/mwwoodworth/brainops-ai-agents:latest
    repo: https://github.com/mwwoodworth/brainops-ai-agents
    branch: main
    envVars:
      - key: PYTHON_VERSION
        value: "3.11"
      # SECURITY: Database credentials must be set in Render dashboard, NOT in this file
      - key: DB_HOST
        sync: false  # Set in Render dashboard
      - key: DB_NAME
        value: postgres
      - key: DB_USER
        sync: false  # Set in Render dashboard
      - key: DB_PASSWORD
        sync: false  # REQUIRED - Set in Render dashboard
      - key: DATABASE_URL
        sync: false
      - key: MCP_DATABASE_URL
        sync: false
      - key: DB_PORT
        value: "6543"  # Transaction mode - higher connection limits than Session mode (5432)
      # SECURITY: API keys must be set in Render dashboard, NOT in this file
      - key: API_KEYS
        sync: false  # Set in Render dashboard
      - key: AGENTS_API_KEY
        sync: false  # Set in Render dashboard
      - key: BRAINOPS_API_KEY
        sync: false  # Set in Render dashboard
      - key: AUTH_REQUIRED
        value: "true"
      - key: DEV_MODE
        value: "false"
      - key: SYSTEM_USER_ID
        value: system
      - key: TENANT_ID
        value: 51e728c5-94e8-4ae0-8a0a-6a08d1fb3457
      - key: PORT
        value: "10000"  # Render's default port
      - key: WEB_CONCURRENCY
        value: "2"  # Optimize for free tier
      - key: LOG_LEVEL
        value: "INFO"
      - key: ENVIRONMENT
        value: "production"
      - key: ALIVE_SELF_STATE_INTERVAL_SEC
        value: "30"
      - key: ENABLE_REASONING_GUARD
        value: "true"
      - key: REASONING_GUARD_CONFIDENCE_THRESHOLD
        value: "0.7"
      - key: REASONING_GUARD_FAIL_OPEN
        value: "false"
      - key: ENABLE_REVENUE_DRIVE
        value: "true"
      - key: REVENUE_DRIVE_DRY_RUN
        value: "false"
      - key: REVENUE_DRIVE_STALE_DAYS
        value: "7"
      - key: REVENUE_DRIVE_OVERDUE_DAYS
        value: "14"
      - key: REVENUE_DRIVE_UPSELL_DAYS
        value: "30"
      - key: REVENUE_DRIVE_MAX_ITEMS
        value: "25"
      - key: REVENUE_DRIVE_COOLDOWN_HOURS
        value: "24"
      # AI API Keys (set in Render dashboard for security)
      - key: OPENAI_API_KEY
        sync: false
      - key: ANTHROPIC_API_KEY
        sync: false
      - key: PERPLEXITY_API_KEY
        sync: false
      - key: GOOGLE_AI_API_KEY
        sync: false
      - key: REDIS_URL
        sync: false
    # Health check for monitoring
    healthCheckPath: /health
    # Auto-deploy on git push
    autoDeploy: true
